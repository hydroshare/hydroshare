{# This template is used as the landing page for NetCDF Resource #}

{% extends "pages/genericresource.html" %}
{% load geoanalytics_tags pages_tags mezzanine_tags crispy_forms_tags %}

{% block extended_metadata %}
    {% if extended_metadata_exists %}
        <div class="row">
            <div class="col-md-12">
                <h2>Extended Metadata</h2>
                <div>

                {# Add the view mode html code below #}
                    {# Add the original coverage meta #}
                    {% if original_coverage %}
                        <h4><strong>Original Coverage:</strong></h4>
                        <hr style="margin-top: 0px;margin-bottom: 2px">
                        {% if original_coverage.name %}
                            <div class="row">
                                <div class="col-sm-4"><strong>Place/Area Name:</strong></div>
                                <div class="col-sm-8">{{ original_coverage.name}}</div>
                            </div>
                        {% endif %}

                        {% if original_coverage.northlimit %}
                            <div class="row">
                                <div class="col-sm-4"><strong>North Limit of Spatial Extent:</strong></div>
                                <div class="col-sm-8">{{ original_coverage.northlimit }}</div>
                            </div>
                        {% endif %}

                        {% if original_coverage.eastlimit %}
                            <div class="row">
                                <div class="col-sm-4"><strong>East Limit of Spatial Extent:</strong></div>
                                <div class="col-sm-8">{{ original_coverage.eastlimit }}</div>
                            </div>
                        {% endif %}

                        {% if original_coverage.southlimit %}
                            <div class="row">
                                <div class="col-sm-4"><strong>South Limit of Spatial Extent:</strong></div>
                                <div class="col-sm-8">{{ original_coverage.southlimit }}</div>
                            </div>
                        {% endif %}

                        {% if original_coverage.westlimit %}
                            <div class="row">
                                <div class="col-sm-4"><strong>West Limit of Spatial Extent:</strong></div>
                                <div class="col-sm-8">{{ original_coverage.westlimit}}</div>
                            </div>
                        {% endif %}

                        {% if original_coverage.units %}
                            <div class="row">
                                <div class="col-sm-4"><strong>Units of Spatial Extent:</strong></div>
                                <div class="col-sm-8">{{ original_coverage.units}}</div>
                            </div>
                        {%  endif %}

                        {% if original_coverage.projection %}
                            <div class="row">
                                <div class="col-sm-4"><strong>Coordinate System Defined in Dataset :</strong></div>
                                <div class="col-sm-8">{{ original_coverage.projection}}</div>
                            </div>
                        {% endif %}

                        {% if original_coverage.projection_string_type %}
                            <div class="row">
                                <div class="col-sm-4"><strong>Coordinate System Text Representation Type :</strong></div>
                                <div class="col-sm-8">{{ original_coverage.projection_string_type}}</div>
                            </div>
                        {%  endif %}

                        {% if original_coverage.projection_string_text %}
                            <div class="row">
                                <div class="col-sm-4"><strong>Coordinate System Text Representation Text:</strong></div>
                                <div class="col-sm-8">{{ original_coverage.projection_string_text}}</div>
                            </div>
                        {%  endif %}

                        <hr>
                    {% endif %}

                    {# Add the Variable meta #}
                    {% if variables %}
                        {% for variable in variables %}
                            <h4><strong>Variable:</strong></h4>
                            <hr style="border-color: dodgerblue; margin-top: 0px;margin-bottom: 2px">
                            {# Required extended meta subelement for Variable #}
                            <div class="row">
                                <div class="col-sm-4"><strong>Name:</strong></div>
                                <div class="col-sm-8">{{ variable.name }}</div>
                            </div>
                            <div class="row">
                                <div class="col-sm-4"><strong>Unit:</strong></div>
                                <div class="col-sm-8">{{ variable.unit }}</div>
                            </div>
                            <div class="row">
                                <div class="col-sm-4"><strong>Type:</strong></div>
                                <div class="col-sm-8">{{ variable.type }}</div>
                            </div>
                            <div class="row">
                                    <div class="col-sm-4"><strong>Shape:</strong></div>
                                    <div class="col-sm-8">{{ variable.shape }}</div>
                            </div>

                            {# Optional extended meta subelement for Variable #}
                            {% if variable.descriptive_name %}
                                <div class="row">
                                    <div class="col-sm-4"><strong>Descriptive Name:</strong></div>
                                    <div class="col-sm-8">{{ variable.descriptive_name }}</div>
                                </div>
                            {% endif %}
                            {% if variable.method %}
                                <div class="row">
                                    <div class="col-sm-4"><strong>Method:</strong></div>
                                    <div class="col-sm-8">{{ variable.method }}</div>
                                </div>
                            {% endif %}
                            {% if variable.missing_value %}
                                <div class="row">
                                    <div class="col-sm-4"><strong>Missing Value:</strong></div>
                                    <div class="col-sm-8">{{ variable.missing_value }}</div>
                                </div>
                            {% endif %}

                        {% endfor %}
                    <hr>
                    {% endif %}

                {# Add ncdump info #}
                {% for f in cm.files.all %}
                    {% if f.resource_file.name|slice:"-3:" == 'txt'%}
                        <div>
                        <h3>NetCDF Data Header Information</h3>
                        <p>{{ f.resource_file.name|slice:"33:" }}</p>
                        {% if f.resource_file.size <= 5000000 %}
                            <textarea readonly rows="20" cols="100">{{ f.resource_file.read}}</textarea>
                        {% else %}
                            <textarea readonly rows="2" cols="100">The size of the netCDF header information text file is too large for loading on the page.</textarea>
                        {% endif %}
                        </div>
                    {% endif %}
                {% endfor %}

                {# Add the view mode html code above #}
                </div>



            </div>
        </div>
    {%  endif %}
{%  endblock %}


{% block extra_js %}

{{ block.super }}

{# put resource specific js below #}
<script type="text/javascript">
    function check_ori_meta_status(){
        var form_action = $("form[id='id-originalcoverage']").attr('action');
        if (form_action.indexOf('update-metadata') > -1) {
            var new_action = form_action.replace('update-metadata', 'delete-metadata');
            var modal_body_text = '<strong>Are you sure you want to delete this metadata element?</strong>'
            $("#delete-original-coverage-element-dialog").find(".modal-body").html(modal_body_text);
            $("#delete-original-coverage-element-dialog").find(".modal-footer").children("a").attr('href',new_action);
            $("#delete-original-coverage-element-dialog").find(".modal-footer").children("a").show()
        }
        else {
            var modal_body_text = '<strong>There is no original coverage metadata for this resource to delete.</strong>'
            $("#delete-original-coverage-element-dialog").find(".modal-body").html(modal_body_text);
            $("#delete-original-coverage-element-dialog").find(".modal-footer").children("a").hide()
        }
    }
</script>

{% endblock %}


